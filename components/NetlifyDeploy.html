<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />

    <link
      class="wf-nf-link"
      rel="stylesheet"
      href="https://www.nerdfonts.com/assets/css/webfont.css"
    />
    <script
      class="wf-tw-script"
      src="https://cdn.tailwindcss.com?plugins=typography"
    ></script>
    <script class="wf-tw-setup">
      tailwind.config = {
        darkMode: location.href.includes("/preview/") ? "media" : "class",
        theme: {
          extend: {
            colors: {
              primary: {
                DEFAULT: "hsl(222.2, 47.4%, 11.2%)",
                foreground: "hsl(210, 40%, 98%)",
              },
              secondary: {
                DEFAULT: "hsl(210, 40%, 96.1%)",
                foreground: "hsl(222.2, 47.4%, 11.2%)",
              },
              muted: {
                DEFAULT: "hsl(210, 40%, 96.1%)",
                foreground: "hsl(215.4, 16.3%, 46.9%)",
              },
            },
          },
        },
      };
    </script>
    <script class="wf-gfonts-script">
      let observer = new MutationObserver((muts) => {
        let gfonts = [];
        for (let mut of muts) {
          if (mut.type === "childList") {
            for (let x of mut.addedNodes) {
              if (x.nodeType !== 1) {
                continue;
              }
              for (let y of [x, ...x.querySelectorAll("*")]) {
                gfonts.push(
                  ...[...y.classList]
                    .filter((x) => x.match(/^gfont-\[.+?\]$/))
                    .map((x) => x.slice("gfont-[".length, -1)),
                );
              }
            }
          } else if (mut.type === "attributes") {
            gfonts.push(
              ...[...mut.target.classList]
                .filter((x) => x.match(/^gfont-\[.+?\]$/))
                .map((x) => x.slice("gfont-[".length, -1)),
            );
          }
        }

        for (let x of gfonts) {
          let id = `gfont-[${x}]`;
          let style = document.getElementById(id);
          if (style) {
            continue;
          }
          style = document.createElement("style");
          style.id = id;
          style.textContent = `
          @import url('https://fonts.googleapis.com/css2?family=${x.replace(/_/g, "+")}:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
          .gfont-\\[${x}\\] { font-family: "${x.replace(/_/g, " ")}" }
        `;
          document.head.append(style);
        }
      });

      observer.observe(document, {
        attributes: true,
        childList: true,
        subtree: true,
      });
    </script>
    <style class="wf-preflight">
      [hidden] {
        display: none !important;
      }
      body {
        display: flow-root;
      }
      :empty {
        min-height: 16px;
      }
    </style>
    <style class="wf-component-preflight">
      body {
        background-color: #06c;
        background-image:
          linear-gradient(rgba(255, 255, 255, 0.2) 2px, transparent 2px),
          linear-gradient(90deg, rgba(255, 255, 255, 0.2) 2px, transparent 1px),
          linear-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px),
          linear-gradient(90deg, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
        background-size:
          100px 100px,
          100px 100px,
          20px 20px,
          20px 20px;
        background-position:
          -2px -2px,
          -2px -2px,
          -1px -1px,
          -1px -1px;
      }
    </style>
  </head>
  <body class="flex justify-center items-center min-h-screen">
    <dialog
      class="outline-none rounded-lg shadow-xl bg-[#091017] w-96 text-neutral-100 p-3 pt-2"
      open=""
    >
      <form
        method="dialog"
        wf-onkeydown="this.onKeyDown(event)"
        wf-onsubmit="this.onSubmit(event)"
        class="flex flex-col gap-1.5"
      >
        <div class="">Netlify Deploy</div>
        <img
          wf-if="!this.sites"
          class="block w-12 mx-auto my-4"
          src="../media/loading.svg" class="w-12"
        />
        <div class="mb-4" wf-if="this.sites">
          <label class="block mb-1 text-sm">Select Site</label>
          <select
            class="w-full rounded px-3 py-2 bg-[#2b2d3130] focus:bg-[#2b2d3150] outline-none"
            wf-value="this.selected"
          >
            <option
              value=""
              wf-if="!this.sites || this.sites.length === 0"
              disabled=""
            >
              No sites available
            </option>
            <option value="new" selected="">Create new site</option>
            <option wf-map="site of this.sites" value="{{site.id}}">
              {{site.ssl_url.slice('https://'.length)}}
            </option>
          </select>
        </div>

        <!-- New Site Creation Section -->
        <div class="mb-4" wf-if="this.selected === 'new'">
          <label class="block mb-1 text-sm">New Site Name</label>
          <input
            type="text"
            placeholder="Enter new site name"
            class="w-full rounded px-3 py-2 bg-[#2b2d3130] focus:bg-[#2b2d3150] outline-none"
            value="{{this.newSiteName}}"
          />
        </div>

        <!-- Buttons -->
        <div class="flex gap-2 justify-end">
          <button
            value="cancel"
            class="rounded px-4 py-2 bg-[#121d2b] hover:bg-[#1a2a40] outline-none text-sm"
          >
            Cancel</button
          ><button
            value="key"
            class="rounded px-4 py-2 bg-[#121d2b] hover:bg-[#1a2a40] outline-none text-sm"
          >
            Change API Key
          </button>
          <button
            value="ok"
            class="rounded px-4 py-2 bg-[#0071b2] hover:bg-[#008ad9] outline-none text-sm disabled:opacity-50"
            wf-disabled="!this.valid"
          >
            Deploy
          </button>
        </div>
      </form>
    </dialog>
  </body>
</html>
